---
title: "VSCodeの右クリックメニューから「Codeで開く」を復活させる方法"
slug: "vscode-right-click-menu-restore"
publishedAt: "2025-08-18T00:00:00Z"
updatedAt: "2025-08-18T00:00:00Z"
tags: ["vscode", "windows", "development"]
description: "VSCodeの右クリックメニューから「Codeで開く」が消えてしまった時の解決方法を2つのパターンで詳しく解説します。再インストールとregファイルを使った手動設定の両方をカバー。"
emoji: "🔧"
---

開発作業をしていると、ファイルやフォルダを右クリックしてVSCodeで開くことが日常茶飯事ですよね。ところが、ある日突然「Codeで開く」メニューが消えてしまうことがあります。

この記事では、そんな困った状況を解決する2つの方法をご紹介します。まずは簡単な再インストール方法から、それでもダメな場合の手動設定まで、段階的に解説していきます。

## 前提条件

この記事はWindows環境を対象としています。レジストリファイルを使った設定はWindows特有の仕組みなので、macOSやLinuxユーザーの方は別の方法が必要になります。

## 問題の確認

まず、実際に「Codeで開く」メニューが消えているかどうか確認してみましょう。

通常であれば、ファイルやフォルダを右クリックした時に以下のようなメニューが表示されるはずです：

- フォルダの場合：「Codeで開く」
- ファイルの場合：「Codeで開く」

これらのメニューが見当たらない場合、以下の方法で復活させることができます。

## 解決方法①：VSCodeの再インストール

最も簡単で確実な方法は、VSCodeを再インストールすることです。

### 手順

1. **VSCode公式サイトにアクセス**
   
   [Visual Studio Code公式サイト](https://code.visualstudio.com/)にアクセスします。

2. **インストーラーをダウンロード**
   
   「Download for Windows」ボタンをクリックしてインストーラーをダウンロードします。

3. **インストールを実行**
   
   ダウンロードしたインストーラーを実行し、インストールウィザードに従って進めます。
   
   **重要なポイント：**
   - 既存のVSCodeをアンインストールする必要はありません
   - インストール時に「右クリックメニューに追加」のオプションが表示される場合は、必ずチェックを入れてください

4. **動作確認**
   
   インストール完了後、適当なファイルやフォルダを右クリックして「Codeで開く」メニューが表示されることを確認します。

この方法で大抵の場合は解決しますが、それでもメニューが表示されない場合は、次の手動設定を試してみてください。

## 解決方法②：regファイルを使った手動設定

再インストールでも解決しない場合は、Windowsのレジストリを直接編集して右クリックメニューを追加します。

### 手順1：VSCodeの実行ファイルパスを特定

まず、VSCodeの実行ファイル（Code.exe）がどこにあるかを調べます。

1. **VSCodeを起動**
   
   VSCodeを起動しておきます。

2. **タスクマネージャーを開く**
   
   `Ctrl + Shift + Esc`を押してタスクマネージャーを開きます。

3. **Code.exeのパスを確認**
   
   - プロセス一覧から「Code.exe」を見つけます
   - 右クリックして「ファイルの場所を開く」を選択
   - エクスプローラーが開いたら、アドレスバーのフルパスをコピーします
   
   例：`C:\Users\ユーザー名\AppData\Local\Programs\Microsoft VS Code\Code.exe`

### 手順2：regファイルを作成

次に、レジストリ設定用のファイルを作成します。

1. **メモ帳を開く**
   
   Windowsのメモ帳を開きます。

2. **以下の内容を貼り付け**
   
   ```registry
   Windows Registry Editor Version 5.00
   
   ; --- フォルダを右クリックしたときの「Code で開く」メニュー ---
   ; ここにはフォルダ用の右クリック設定を登録する
   [HKEY_CLASSES_ROOT\Directory\shell\VSCode]
   @="Code で開く"
   "Icon"="\"C:\\Users\\ユーザー名\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\",0"
   
   [HKEY_CLASSES_ROOT\Directory\shell\VSCode\command]
   @="\"C:\\Users\\ユーザー名\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\" \"%V\""
   
   ; --- ファイルを右クリックしたときの「Code で開く」メニュー ---
   ; ここにはファイル用の右クリック設定を登録する
   [HKEY_CLASSES_ROOT\*\shell\VSCode]
   @="Code で開く"
   "Icon"="\"C:\\Users\\ユーザー名\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\",0"
   
   [HKEY_CLASSES_ROOT\*\shell\VSCode\command]
   @="\"C:\\Users\\ユーザー名\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\" \"%1\""
   ```

3. **パスを置き換え**
   
   `ユーザー名`の部分を、あなたのWindowsユーザー名に置き換えます。
   
   例：手順1で調べたパスが`C:\Users\john\AppData\Local\Programs\Microsoft VS Code\Code.exe`の場合、
   ```
   C:\\Users\\john\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe
   ```
   のように設定します。

4. **ファイルを保存**
   
   ファイル名を「vscode-menu.reg」などの`.reg`拡張子で保存します。

### 手順3：レジストリに設定を適用

1. **regファイルを実行**
   
   作成した`.reg`ファイルをダブルクリックします。

2. **確認ダイアログで「はい」を選択**
   
   「レジストリエディターで情報を追加しますか？」というダイアログが表示されるので「はい」をクリックします。

3. **完了メッセージを確認**
   
   「レジストリに正常に追加されました」というメッセージが表示されたら「OK」をクリックします。

### 手順4：エクスプローラーを再起動

レジストリの変更を反映させるため、エクスプローラーを再起動します。

1. タスクマネージャー（`Ctrl + Shift + Esc`）を開く
2. 「エクスプローラー」を選択
3. 「再起動」ボタンをクリック

### 手順5：動作確認

エクスプローラーが再起動したら、以下を確認します：

- 適当なフォルダを右クリック → 「Codeで開く」が表示される
- 適当なファイルを右クリック → 「Codeで開く」が表示される

## 設定を削除したい場合

もし設定を間違えてしまった場合や、右クリックメニューを削除したい場合は、以下の削除用regファイルを使用できます。

### 削除用regファイルの作成

1. **メモ帳を開く**
   
   新しくメモ帳を開きます。

2. **以下の内容を貼り付け**
   
   ```registry
   Windows Registry Editor Version 5.00
   
   ; --- フォルダ用「Code で開く」メニューを削除 ---
   [-HKEY_CLASSES_ROOT\Directory\shell\VSCode]
   
   ; --- ファイル用「Code で開く」メニューを削除 ---
   [-HKEY_CLASSES_ROOT\*\shell\VSCode]
   ```

3. **ファイルを保存**
   
   ファイル名を「vscode-menu-remove.reg」などの`.reg`拡張子で保存します。

4. **削除を実行**
   
   作成した削除用`.reg`ファイルをダブルクリックし、確認ダイアログで「はい」を選択します。

5. **エクスプローラーを再起動**
   
   前述の方法でエクスプローラーを再起動すると、右クリックメニューから「Codeで開く」が削除されます。

## トラブルシューティング

### メニューが表示されない場合

- パスが正しく設定されているか確認
- ユーザー名が正しく置き換えられているか確認
- VSCodeが正しくインストールされているか確認

### 権限エラーが発生する場合

- 管理者権限でregファイルを実行してみる
- ウイルス対策ソフトがブロックしていないか確認

### 設定を間違えた場合

- 上記の削除用regファイルを使用して設定をリセット
- その後、正しい設定で再度追加

## まとめ

VSCodeの右クリックメニューが消えてしまった場合の解決方法を2つご紹介しました。

**解決方法①：再インストール**
- 最も簡単で確実
- 既存の設定は保持される
- ほとんどの場合はこれで解決

**解決方法②：手動設定**
- 再インストールで解決しない場合に有効
- レジストリを直接編集するため、より確実
- 少し手間はかかるが、根本的な解決が可能

開発効率を大きく左右する小さな機能ですが、なくなると本当に不便ですよね。この記事が同じ問題で困っている方の助けになれば幸いです。

> **注意：** この記事の内容は2025年8月時点の情報に基づいています。VSCodeのバージョンアップデートにより、設定方法が変更される可能性があります。